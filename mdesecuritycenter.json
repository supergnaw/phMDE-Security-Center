{
  "appid": "14b2b770-93ca-4684-b41e-d585f8466a61",
  "name": "MDE Security Center",
  "description": "Splunk SOAR connector module for interacting with the Microsoft Defender for Endpoint Security Center API.",
  "type": "endpoint",
  "main_module": "mdesecuritycenter_connector.py",
  "app_version": "1.0.7",
  "product_vendor": "Microsoft",
  "product_name": "Microsoft 365 Defender for Endpoint",
  "product_version_regex": ".*",
  "publisher": "Supernawesome L.L.C.",
  "package_name": "phantom_mdesecuritycenter",
  "license": "GNU General Public License v3.0",
  "consolidate_widgets": true,
  "url": "https://github.com/supergnaw/phMDE-Security-Center",
  "logo": "logo_mdesecuritycenter.svg",
  "logo_dark": "logo_mdesecuritycenter_dark.svg",
  "python_version": "3",
  "utctime_updated": "2022-05-26T06:24:07.659521Z",
  "min_phantom_version": "5.3.0",
  "latest_tested_versions": [
    "*.securitycenter.microsoft.com/test, 10 Aug 2023"
  ],
  "fips_compliant": true,
  "configuration": {
    "api_uri": {
      "data_type": "string",
      "description": "API Endpoint Server URI",
      "required": true,
      "value_list": [
        "https://api-eu.*.microsoft.com",
        "https://api-gcc.*.microsoft.us",
        "https://api-gov.*.microsoft.us",
        "https://api-uk.*.microsoft.com",
        "https://api-us.*.microsoft.com"
      ],
      "default": "https://api-us.*.microsoft.com",
      "order": 0
    },
    "tenant_id": {
      "data_type": "string",
      "description": "Tenant ID",
      "required": true,
      "order": 1
    },
    "client_id": {
      "data_type": "string",
      "description": "Client ID",
      "required": true,
      "order": 2
    },
    "client_secret": {
      "data_type": "password",
      "description": "Client Secret",
      "required": true,
      "order": 3
    },
    "ingest_window": {
      "data_type": "numeric",
      "description": "Rolling ingestion window in hours (default: 24)",
      "required": false,
      "order": 4
    },
    "max_incidents": {
      "data_type": "numeric",
      "description": "Max incident to parse from MDE in the ingestion window (default: 250)",
      "required": false,
      "default": 250,
      "order": 5
    },
    "placeholder_7": {
      "data_type": "ph",
      "order": 6
    },
    "placeholder_7": {
      "data_type": "ph",
      "order": 7
    },
    "mde_ingest_comment": {
      "data_type": "string",
      "description": "Default MDE comment to add on incident ingest",
      "required": false,
      "order": 8
    },
    "mde_closure_comment": {
      "data_type": "string",
      "description": "Default MDE comment to add on incident closure",
      "required": false,
      "order": 9
    },
    "filter_list": {
      "data_type": "string",
      "description": "Filter rules custom list (default: 'MDE Security Center Ingest Filter')",
      "required": false,
      "default": "MDE Security Center Ingest Filter",
      "order": 10
    },
    "placeholder_7": {
      "data_type": "ph",
      "order": 11
    },
    "field_mapping": {
      "data_type": "string",
      "description": "Field Mapping: A JSON string of {'old_field_name':'new_field_name'} for on-the-fly field renaming",
      "required": false,
      "default": "",
      "order": 12
    },
    "on_poll_behavior": {
      "data_type": "string",
      "description": "Behavior of on poll action for incidents with no filter rule match (default: ignore)",
      "required": false,
      "value_list": [
        "ingest",
        "ignore"
      ],
      "default": "ignore",
      "order": 13
    }
  },
  "actions": [
    {
      "action": "test connectivity",
      "identifier": "test_connectivity",
      "description": "Verifies app connection with MDE.",
      "verbose": "Validates the asset configuration for connectivity using the supplied configuration and displays summaries of all authentication tokens",
      "type": "test",
      "read_only": true,
      "parameters": {
        "force_refresh": {
          "description": "Remove cached tokens and revalidate credentials.",
          "data_type": "boolean",
          "required": false
        }
      },
      "output": [
        {
          "data_path": "action_result.data.endpoint",
          "data_type": "string",
          "example_values": [
            "https://api-gov.security.microsoft.us"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.expires_in",
          "data_type": "string",
          "example_values": [
            "60m 0s"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.expires_on",
          "data_type": "string",
          "example_values": [
            "2023-09-13 21:29:46"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.roles.*",
          "data_type": "string",
          "example_values": [
            "Incident.ReadWrite.All",
            "Incident.Read.All",
            "AdvancedHunting.Read.All"
          ],
          "contains": []
        }
      ],
      "versions": "EQ(*)"
    },
    {
      "action": "list incidents",
      "identifier": "list_incidents",
      "description": "Retrieves a collection of Incidents.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender/api-list-incidents' target='_blank'>Microsoft Docs - List incidents API in Microsoft 365 Defender</a>",
      "type": "information",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "filter": {
          "description": "filters to apply: (createdTime ge 2023-08-21T12:00:00Z and status eq 'active')",
          "data_type": "string",
          "required": false
        },
        "top": {
          "description": "limit results to the top x results",
          "data_type": "numeric",
          "required": false,
          "default": 100
        },
        "skip": {
          "description": "skip the first x results",
          "data_type": "numeric",
          "required": false,
          "default": 0
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.*.source_data_identifier",
          "data_type": "string",
          "example_values": [
            "c55942da-f4c0-49ca-8fe9-1aeda73df676"
          ],
          "contains": [
            "uuid"
          ]
        },
        {
          "data_path": "action_result.data.*.incidentId",
          "data_type": "numeric",
          "example_values": [
            68594,
            12345,
            54321
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.incidentUri",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
            "url"
          ]
        },
        {
          "data_path": "action_result.data.*.redirectIncidentId",
          "data_type": "string",
          "example_values": [
            "None"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.incidentName",
          "data_type": "string",
          "example_values": [
            "Suspicious activity"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.createdTime",
          "data_type": "string",
          "example_values": [
            "2023-08-21T18:02:40.84Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.lastUpdateTime",
          "data_type": "string",
          "example_values": [
            "2023-08-21T18:02:46.3Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.assignedTo",
          "data_type": "string",
          "example_values": [
            "None",
            "user@email.com"
          ],
          "contains": [
            "email"
          ]
        },
        {
          "data_path": "action_result.data.*.classification",
          "data_type": "string",
          "example_values": [
            "Unknown"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.determination",
          "data_type": "string",
          "example_values": [
            "NotAvailable"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.detectionSource",
          "data_type": "string",
          "example_values": [
            "Defender for Cloud Apps"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.status",
          "data_type": "string",
          "example_values": [
            "Active"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.severity",
          "data_type": "string",
          "example_values": [
            "Low",
            "Medium"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.tags.*",
          "data_type": "string",
          "example_values": [
            "tag a",
            "Tag B"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.comments.*",
          "data_type": "string",
          "example_values": [
            "Interesting comment goes here."
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.source_data_identifier",
          "data_type": "string",
          "example_values": [
            "53347d49-f83e-4569-9866-86f62977986b"
          ],
          "contains": [
            "uuid"
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.alertId",
          "data_type": "string",
          "example_values": [
            "caD70CFEE2-1F54-32DB-9988-3A868A1EBFAC"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.providerAlertId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.incidentId",
          "data_type": "numeric",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.serviceSource",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.creationTime",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.lastUpdatedTime",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.resolvedTime",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.firstActivity",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.lastActivity",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.title",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.description",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.category",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.status",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.severity",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.investigationId",
          "data_type": "numeric",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.investigationState",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.classification",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.determination",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.detectionSource",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.detectorId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.assignedTo",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.actorName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.threatFamilyName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.mitreTechniques",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.mdatpDeviceId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.aadDeviceId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.deviceDnsName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.osPlatform",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.version",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.osProcessor",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.osBuild",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.healthStatus",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.riskScore",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.rbacGroupName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.firstSeen",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.tags.*",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.defenderAvStatus",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.onboardingStatus",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.vmMetadata",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.loggedOnUsers.*.accountName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.loggedOnUsers.*.domainName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.entityType",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.sha1",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.sha256",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.fileName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.filePath",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.processId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.processCommandLine",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.processCreationTime",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.parentProcessId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.parentProcessCreationTime",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.ipAddress",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.url",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.accountName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.domainName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.userSid",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.aadUserId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.userPrincipalName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.mailboxDisplayName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.mailboxAddress",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.clusterBy",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.sender",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.recipient",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.subject",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.deliveryAction",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.securityGroupId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.securityGroupName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.registryHive",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.registryKey",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.registryValueType",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.registryValue",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.deviceId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "get incident",
      "identifier": "get_incident",
      "description": "Retrieves a specific incident by its ID.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender/api-get-incident' target='_blank'>Microsoft Docs - Get incident information API</a>",
      "type": "information",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "incident_id": {
          "description": "Incident ID",
          "data_type": "numeric",
          "required": true,
          "primary": false
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.source_data_identifier",
          "data_type": "string",
          "example_values": [
            "c55942da-f4c0-49ca-8fe9-1aeda73df676"
          ],
          "contains": [
            "uuid"
          ]
        },
        {
          "data_path": "action_result.data.incidentId",
          "data_type": "numeric",
          "example_values": [
            68594,
            12345,
            54321
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.incidentUri",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
            "url"
          ]
        },
        {
          "data_path": "action_result.data.redirectIncidentId",
          "data_type": "string",
          "example_values": [
            "None"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.incidentName",
          "data_type": "string",
          "example_values": [
            "Suspicious activity"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.createdTime",
          "data_type": "string",
          "example_values": [
            "2023-08-21T18:02:40.84Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.lastUpdateTime",
          "data_type": "string",
          "example_values": [
            "2023-08-21T18:02:46.3Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.assignedTo",
          "data_type": "string",
          "example_values": [
            "None",
            "user@email.com"
          ],
          "contains": [
            "email"
          ]
        },
        {
          "data_path": "action_result.data.classification",
          "data_type": "string",
          "example_values": [
            "Unknown"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.determination",
          "data_type": "string",
          "example_values": [
            "NotAvailable"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.detectionSource",
          "data_type": "string",
          "example_values": [
            "Defender for Cloud Apps"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.status",
          "data_type": "string",
          "example_values": [
            "Active"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.severity",
          "data_type": "string",
          "example_values": [
            "Low",
            "Medium"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.tags.*",
          "data_type": "string",
          "example_values": [
            "tag a",
            "Tag B"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.comments.*",
          "data_type": "string",
          "example_values": [
            "Interesting comment goes here."
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.source_data_identifier",
          "data_type": "string",
          "example_values": [
            "53347d49-f83e-4569-9866-86f62977986b"
          ],
          "contains": [
            "uuid"
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.alertId",
          "data_type": "string",
          "example_values": [
            "caD70CFEE2-1F54-32DB-9988-3A868A1EBFAC"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.providerAlertId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.incidentId",
          "data_type": "numeric",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.serviceSource",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.creationTime",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.lastUpdatedTime",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.resolvedTime",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.firstActivity",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.lastActivity",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.title",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.description",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.category",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.status",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.severity",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.investigationId",
          "data_type": "numeric",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.investigationState",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.classification",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.determination",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.detectionSource",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.detectorId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.assignedTo",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.actorName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.threatFamilyName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.mitreTechniques",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.devices.*.mdatpDeviceId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.devices.*.aadDeviceId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.devices.*.deviceDnsName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.devices.*.osPlatform",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.devices.*.version",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.devices.*.osProcessor",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.devices.*.osBuild",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.devices.*.healthStatus",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.devices.*.riskScore",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.devices.*.rbacGroupName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.devices.*.firstSeen",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.devices.*.tags.*",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.devices.*.defenderAvStatus",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.devices.*.onboardingStatus",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.devices.*.vmMetadata",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.devices.*.loggedOnUsers.*.accountName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.devices.*.loggedOnUsers.*.domainName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.entityType",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.sha1",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.sha256",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.fileName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.filePath",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.processId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.processCommandLine",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.processCreationTime",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.parentProcessId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.parentProcessCreationTime",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.ipAddress",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.url",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.accountName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.domainName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.userSid",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.aadUserId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.userPrincipalName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.mailboxDisplayName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.mailboxAddress",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.clusterBy",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.sender",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.recipient",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.subject",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.deliveryAction",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.securityGroupId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.securityGroupName",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.registryHive",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.registryKey",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.registryValueType",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.registryValue",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alerts.*.entities.*.deviceId",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "update incident",
      "identifier": "update_incident",
      "description": "Updates properties of existing incident.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender/api-update-incidents' target='_blank'>Microsoft Docs - Update incidents API</a>",
      "type": "investigative",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "incident_id": {
          "description": "Incident ID",
          "data_type": "numeric",
          "required": true,
          "primary": false
        },
        "status": {
          "description": "Specifies the current status of the incident",
          "data_type": "string",
          "required": true,
          "primary": false,
          "value_list": [
            "No Change",
            "Active",
            "Resolved",
            "Redirected"
          ],
          "default": "No Change"
        },
        "assigned_to": {
          "description": "Owner of the incident",
          "data_type": "string",
          "required": false,
          "primary": false
        },
        "category": {
          "description": "Classification and determination of the incident",
          "data_type": "string",
          "required": false,
          "primary": false,
          "value_list": [
            "No Change",
            "None (removes current classification/determination)",
            "Informational: Security test",
            "Informational: Line-of-business application",
            "Informational: Confirmed activity",
            "Informational: Other",
            "False positive: Not malicious",
            "False positive: Not enough data to validate",
            "False positive: Other",
            "True positive: Multistage attack",
            "True positive: Malicious user activity",
            "True positive: Compromised account",
            "True positive: Malware",
            "True positive: Phishing",
            "True positive: Unwanted software",
            "True positive: Other"
          ],
          "default": "No Change"
        },
        "tags": {
          "description": "List of incident tags",
          "data_type": "string",
          "required": false,
          "primary": false,
          "allow_list": true
        },
        "remove_tags": {
          "description": "Remove existing incident tags",
          "data_type": "boolean",
          "required": false
        },
        "comment": {
          "description": "Comment to be added to the incident",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.status",
          "data_type": "string",
          "example_values": [
            "Resolved",
            "Active"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.assignedTo",
          "data_type": "string",
          "example_values": [
            "secop2@contoso.com"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.classification",
          "data_type": "string",
          "example_values": [
            "TruePositive"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.determination",
          "data_type": "string",
          "example_values": [
            "Malware"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.tags.*",
          "data_type": "string",
          "example_values": [
            "Yossi's playground",
            "Don't mess with the Zohan"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.comments.*.comment",
          "data_type": "string",
          "example_values": [
            "pen testing",
            "valid incident"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.comments.*.createdBy",
          "data_type": "string",
          "example_values": [
            "secop2@contoso.com"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.comments.*.createdTime",
          "data_type": "string",
          "example_values": [
            "2021-05-02T09:34:21.5519738Z",
            "2021-05-02-T09:36:27.6652581Z"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "list alerts",
      "identifier": "list_alerts",
      "description": "Retrieves a collection of Alerts.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-alerts' target='_blank'>Microsoft Docs - List alerts API</a>",
      "type": "informational",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "filter": {
          "description": "filters to apply: (createdTime ge 2023-08-21T12:00:00Z and status eq 'active')",
          "data_type": "string",
          "required": false
        },
        "top": {
          "description": "limit results to the top x results",
          "data_type": "numeric",
          "required": false,
          "default": 500
        },
        "skip": {
          "description": "skip the first x results",
          "data_type": "numeric",
          "required": false,
          "default": 0
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.*.id",
          "data_type": "string",
          "example_values": [
            "da637472900382838869_1364969609"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alertId",
          "data_type": "string",
          "example_values": [
            "da637472900382838869_1364969609"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.source_data_identifier",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.title",
          "data_type": "string",
          "example_values": [
            "Low-reputation arbitrary code executed by signed executable"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.description",
          "data_type": "string",
          "example_values": [
            "Binaries signed by Microsoft can be used to run low-reputation arbitrary code. This technique hides the execution of malicious code within a trusted process. As a result, the trusted process might exhibit suspicious behaviors, such as opening a listening port or connecting to a command-and-control (C&C) server."
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.alertCreationTime",
          "data_type": "string",
          "example_values": [
            "2021-01-26T20:33:57.7220239Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.lastEventTime",
          "data_type": "string",
          "example_values": [
            "2021-01-26T20:31:33.0577322Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.firstEventTime",
          "data_type": "string",
          "example_values": [
            "2021-01-26T20:31:32.9562661Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.lastUpdateTime",
          "data_type": "string",
          "example_values": [
            "2021-01-26T20:33:59.2Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.resolvedTime",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.incidentId",
          "data_type": "numeric",
          "example_values": [
            1126093
          ],
          "contains": [
            "url"
          ]
        },
        {
          "data_path": "action_result.data.*.investigationId",
          "data_type": "numeric",
          "example_values": [
            null
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.investigationState",
          "data_type": "string",
          "example_values": [
            "Unknown",
            "Terminated",
            "SuccessfullyRemediated",
            "Benign",
            "Failed",
            "PartiallyRemediated",
            "Running",
            "PendingApproval",
            "PendingResource",
            "PartiallyInvestigated",
            "TerminatedByUser",
            "TerminatedBySystem",
            "Queued",
            "InnerFailure",
            "PreexistingAlert",
            "UnsupportedOs",
            "UnsupportedAlertType",
            "SuppressedAlert"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.assignedTo",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.rbacGroupName",
          "data_type": "string",
          "example_values": [
            "A"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.mitreTechniques",
          "data_type": "string",
          "example_values": [
            "T1064",
            "T1085",
            "T1220"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.severity",
          "data_type": "string",
          "example_values": [
            "UnSpecified",
            "Informational",
            "Low",
            "Medium",
            "High"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.status",
          "data_type": "string",
          "example_values": [
            "Unknown",
            "New",
            "InProgress",
            "Resolved"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.classification",
          "data_type": "string",
          "example_values": [
            "TruePositive",
            "InformationalExpectedActivity",
            "FalsePositive"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.determination",
          "data_type": "string",
          "example_values": [
            "MultiStagedAttack",
            "MaliciousUserActivity",
            "CompromisedUser",
            "Malware",
            "Phishing",
            "UnwantedSoftware",
            "SecurityTesting",
            "LineOfBusinessApplication",
            "ConfirmedUserActivity",
            "Clean",
            "InsufficientData",
            "Other"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.category",
          "data_type": "string",
          "example_values": [
            "Execution"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.detectionSource",
          "data_type": "string",
          "example_values": [
            "WindowsDefenderAtp"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.threatFamilyName",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "get alert",
      "identifier": "get_alert",
      "description": "Retrieves specific Alert by its ID.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-alert-info-by-id' target='_blank'>Microsoft Docs - Get alert information by ID API</a>",
      "type": "informational",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "alert_id": {
          "description": "Alert ID",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.id",
          "data_type": "string",
          "example_values": [
            "da637472900382838869_1364969609"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alertId",
          "data_type": "string",
          "example_values": [
            "da637472900382838869_1364969609"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.source_data_identifier",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.title",
          "data_type": "string",
          "example_values": [
            "Low-reputation arbitrary code executed by signed executable"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.description",
          "data_type": "string",
          "example_values": [
            "Binaries signed by Microsoft can be used to run low-reputation arbitrary code. This technique hides the execution of malicious code within a trusted process. As a result, the trusted process might exhibit suspicious behaviors, such as opening a listening port or connecting to a command-and-control (C&C) server."
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.alertCreationTime",
          "data_type": "string",
          "example_values": [
            "2021-01-26T20:33:57.7220239Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.lastEventTime",
          "data_type": "string",
          "example_values": [
            "2021-01-26T20:31:33.0577322Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.firstEventTime",
          "data_type": "string",
          "example_values": [
            "2021-01-26T20:31:32.9562661Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.lastUpdateTime",
          "data_type": "string",
          "example_values": [
            "2021-01-26T20:33:59.2Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.resolvedTime",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.incidentId",
          "data_type": "numeric",
          "example_values": [
            1126093
          ],
          "contains": [
            "url"
          ]
        },
        {
          "data_path": "action_result.data.investigationId",
          "data_type": "numeric",
          "example_values": [
            null
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.investigationState",
          "data_type": "string",
          "example_values": [
            "Unknown",
            "Terminated",
            "SuccessfullyRemediated",
            "Benign",
            "Failed",
            "PartiallyRemediated",
            "Running",
            "PendingApproval",
            "PendingResource",
            "PartiallyInvestigated",
            "TerminatedByUser",
            "TerminatedBySystem",
            "Queued",
            "InnerFailure",
            "PreexistingAlert",
            "UnsupportedOs",
            "UnsupportedAlertType",
            "SuppressedAlert"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.assignedTo",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.rbacGroupName",
          "data_type": "string",
          "example_values": [
            "A"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.mitreTechniques",
          "data_type": "string",
          "example_values": [
            "T1064",
            "T1085",
            "T1220"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.severity",
          "data_type": "string",
          "example_values": [
            "UnSpecified",
            "Informational",
            "Low",
            "Medium",
            "High"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.status",
          "data_type": "string",
          "example_values": [
            "Unknown",
            "New",
            "InProgress",
            "Resolved"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.classification",
          "data_type": "string",
          "example_values": [
            "TruePositive",
            "InformationalExpectedActivity",
            "FalsePositive"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.determination",
          "data_type": "string",
          "example_values": [
            "MultiStagedAttack",
            "MaliciousUserActivity",
            "CompromisedUser",
            "Malware",
            "Phishing",
            "UnwantedSoftware",
            "SecurityTesting",
            "LineOfBusinessApplication",
            "ConfirmedUserActivity",
            "Clean",
            "InsufficientData",
            "Other"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.category",
          "data_type": "string",
          "example_values": [
            "Execution"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.detectionSource",
          "data_type": "string",
          "example_values": [
            "WindowsDefenderAtp"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.threatFamilyName",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "update alert",
      "identifier": "update_alert",
      "description": "Updates properties of existing Alert.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/update-alert' target='_blank'>Microsoft Docs - Update alert</a>",
      "type": "investigative",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "alert_id": {
          "description": "Alert ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "status": {
          "description": "Specifies the current status of the incident",
          "data_type": "string",
          "required": true,
          "primary": false,
          "value_list": [
            "No Change",
            "New",
            "In Progress",
            "Resolved"
          ],
          "default": "No Change"
        },
        "assigned_to": {
          "description": "Owner of the incident",
          "data_type": "string",
          "required": false,
          "primary": false
        },
        "category": {
          "description": "Classification and determination of the incident",
          "data_type": "string",
          "required": false,
          "primary": false,
          "value_list": [
            "No Change",
            "Informational: Security test",
            "Informational: Line-of-business application",
            "Informational: Confirmed activity",
            "Informational: Other",
            "False positive: Not malicious",
            "False positive: Not enough data to validate",
            "False positive: Other",
            "True positive: Multistage attack",
            "True positive: Malicious user activity",
            "True positive: Compromised account",
            "True positive: Malware",
            "True positive: Phishing",
            "True positive: Unwanted software",
            "True positive: Other"
          ],
          "default": "No Change"
        },
        "comment": {
          "description": "Comment to be added to the incident",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.status",
          "data_type": "string",
          "example_values": [
            "Resolved"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.assignedTo",
          "data_type": "string",
          "example_values": [
            "secop2@contoso.com"
          ],
          "contains": [
            "email"
          ]
        },
        {
          "data_path": "action_result.data.classification",
          "data_type": "string",
          "example_values": [
            "FalsePositive"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.determination",
          "data_type": "string",
          "example_values": [
            "Malware"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.comment",
          "data_type": "string",
          "example_values": [
            "Resolve my alert and assign to secop2"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "update alert batch",
      "identifier": "update_alert_batch",
      "description": "Updates properties of a batch of existing Alerts.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/batch-update-alerts' target='_blank'>Microsoft Docs - Batch update alerts</a>",
      "type": "investigative",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "alert_list": {
          "description": "Alert ID List",
          "data_type": "string",
          "required": true,
          "primary": false,
          "allow_list": true
        },
        "status": {
          "description": "Specifies the current status of the incident",
          "data_type": "string",
          "required": true,
          "primary": false,
          "value_list": [
            "No Change",
            "Active",
            "Resolved",
            "Redirected"
          ],
          "default": "No Change"
        },
        "assigned_to": {
          "description": "Owner of the incident",
          "data_type": "string",
          "required": false,
          "primary": false
        },
        "category": {
          "description": "Classification and determination of the incident",
          "data_type": "string",
          "required": false,
          "primary": false,
          "value_list": [
            "No Change",
            "Informational: Security test",
            "Informational: Line-of-business application",
            "Informational: Confirmed activity",
            "Informational: Other",
            "False positive: Not malicious",
            "False positive: Not enough data to validate",
            "False positive: Other",
            "True positive: Multistage attack",
            "True positive: Malicious user activity",
            "True positive: Compromised account",
            "True positive: Malware",
            "True positive: Phishing",
            "True positive: Unwanted software",
            "True positive: Other"
          ],
          "default": "No Change"
        },
        "comment": {
          "description": "Comment to be added to the incident",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.alertIds.*",
          "data_type": "string",
          "example_values": [
            "da637399794050273582_760707377",
            "da637399989469816469_51697947354"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.status",
          "data_type": "string",
          "example_values": [
            "Resolved"
          ],
          "contains": [
            "email"
          ]
        },
        {
          "data_path": "action_result.data.assignedTo",
          "data_type": "string",
          "example_values": [
            "secop2@contoso.com"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.classification",
          "data_type": "string",
          "example_values": [
            "FalsePositive"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.determination",
          "data_type": "string",
          "example_values": [
            "Malware"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.comment",
          "data_type": "string",
          "example_values": [
            "Resolve my alert and assign to secop2"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "list alert files",
      "identifier": "list_alert_files",
      "description": "Retrieves all files related to a specific alert.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-alert-related-files-info' target='_blank'>Microsoft Docs - Get alert related files information API</a>",
      "type": "investigative",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "alert_id": {
          "description": "Alert ID",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.*.sha1",
          "data_type": "string",
          "example_values": [
            "f2a00fd2f2de1be0214b8529f1e9f67096c1aa70"
          ],
          "contains": [
            "sha1"
          ]
        },
        {
          "data_path": "action_result.data.*.sha256",
          "data_type": "string",
          "example_values": [
            "dcd71ef5fff4362a9f64cf3f96f14f2b11d6f428f3badbedcb9ff3361e7079aa"
          ],
          "contains": [
            "sha256"
          ]
        },
        {
          "data_path": "action_result.data.*.md5",
          "data_type": "string",
          "example_values": [
            "8d5b7cc9a832e21d22503057e1fec8e9"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.globalPrevalence",
          "data_type": "numeric",
          "example_values": [
            29
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.globalFirstObserved",
          "data_type": "string",
          "example_values": [
            "2019-03-23T23:54:06.0135204Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.globalLastObserved",
          "data_type": "string",
          "example_values": [
            "2019-04-23T00:43:20.0489831Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.size",
          "data_type": "numeric",
          "example_values": [
            113984
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.fileType",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.isPeFile",
          "data_type": "boolean",
          "example_values": [
            true,
            false
          ],
          "contains": [
            "url"
          ]
        },
        {
          "data_path": "action_result.data.*.filePublisher",
          "data_type": "string",
          "example_values": [
            "Microsoft Corporation"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.fileProductName",
          "data_type": "string",
          "example_values": [
            "MicrosoftÂ© WindowsÂ© Operating System"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.signer",
          "data_type": "string",
          "example_values": [
            "Microsoft Corporation"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.issuer",
          "data_type": "string",
          "example_values": [
            "Microsoft Code Signing PCA"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.signerHash",
          "data_type": "string",
          "example_values": [
            "9dc17888b5cfad98b3cb35c1994e96227f061675"
          ],
          "contains": [
            "sha1"
          ]
        },
        {
          "data_path": "action_result.data.*.isValidCertificate",
          "data_type": "boolean",
          "example_values": [
            true,
            false
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.determinationType",
          "data_type": "string",
          "example_values": [
            "Unknown"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.determinationValue",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "list library scripts",
      "identifier": "list_library_scripts",
      "description": "List live response library files.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/list-library-files' target='_blank'>Microsoft Docs - List library files</a>",
      "type": "forensic",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.*.fileName",
          "data_type": "string",
          "example_values": [
            "script1.ps1"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.sha256",
          "data_type": "string",
          "example_values": [
            "6e212a0db618507c44e4ec8ee7499dfef7e5767e5f8d31144df3b96fd1145caf"
          ],
          "contains": [
            "sha256"
          ]
        },
        {
          "data_path": "action_result.data.*.description",
          "data_type": "string",
          "example_values": [
            "description goes here"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.creationTime",
          "data_type": "string",
          "example_values": [
            "2019-10-24T10:54:23.2009016Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.lastUpdatedTime",
          "data_type": "string",
          "example_values": [
            "2019-10-24T10:54:23.2009016Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.createdBy",
          "data_type": "string",
          "example_values": [
            "admin"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.hasParameters",
          "data_type": "boolean",
          "example_values": [
            true,
            false
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.parametersDescription",
          "data_type": "string",
          "example_values": [
            "test"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "run actions",
      "identifier": "run_actions",
      "description": "Runs a sequence of live response commands on a device.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/run-live-response' target='_blank'>Microsoft Docs - Run live response commands on a device</a>",
      "type": "forensic",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "action_commands": {
          "description": "Action commands",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.*.id",
          "data_type": "string",
          "example_values": [
            "{machine_action_id}"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.type",
          "data_type": "string",
          "example_values": [
            "LiveResponse"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.requestor",
          "data_type": "string",
          "example_values": [
            "analyst@microsoft.com"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.requestorComment",
          "data_type": "string",
          "example_values": [
            "Testing Live Response API"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.status",
          "data_type": "string",
          "example_values": [
            "Pending"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.machineId",
          "data_type": "string",
          "example_values": [
            "{machine_id}"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.computerDnsName",
          "data_type": "string",
          "example_values": [
            "hostname"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.creationDateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2021-02-04T15:36:52.7788848Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.lastUpdateDateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2021-02-04T15:36:52.7788848Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.errorHResult",
          "data_type": "numeric",
          "example_values": [
            0
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.index",
          "data_type": "numeric",
          "example_values": [
            0
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.startTime",
          "data_type": "string",
          "example_values": [
            "2023-02-06T17:19:52.7788848Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.endTime",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.commandStatus",
          "data_type": "string",
          "example_values": [
            "Created"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.errors.*",
          "data_type": "string",
          "example_values": [
            ""
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.type",
          "data_type": "string",
          "example_values": [
            "PutFile",
            "RunScript",
            "GetFile"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.params.*.key",
          "data_type": "string",
          "example_values": [
            "ScriptName",
            "Args",
            "path"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.params.*.value",
          "data_type": "string",
          "example_values": [
            "minidump.ps1",
            "OfficeClickToRun",
            "C:\\windows\\TEMP\\OfficeClickToRun.dmp.zip"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "run action",
      "identifier": "run_action",
      "description": "Runs a single live response commands on a device.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/run-live-response' target='_blank'>Microsoft Docs - Run live response commands on a device</a>",
      "type": "forensic",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "command_type": {
          "description": "Command Type",
          "data_type": "string",
          "required": true,
          "primary": false,
          "value_list": [
            "PutFile",
            "RunScript",
            "GetFile"
          ]
        },
        "file_name": {
          "description": "File Name/Script Name/Path",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "arguments": {
          "description": "Script arguments, if any",
          "data_type": "string",
          "required": false,
          "primary": false
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.*.id",
          "data_type": "string",
          "example_values": [
            "{machine_action_id}"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.type",
          "data_type": "string",
          "example_values": [
            "LiveResponse"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.requestor",
          "data_type": "string",
          "example_values": [
            "analyst@microsoft.com"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.requestorComment",
          "data_type": "string",
          "example_values": [
            "Testing Live Response API"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.status",
          "data_type": "string",
          "example_values": [
            "Pending"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.machineId",
          "data_type": "string",
          "example_values": [
            "{machine_id}"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.computerDnsName",
          "data_type": "string",
          "example_values": [
            "hostname"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.creationDateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2021-02-04T15:36:52.7788848Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.lastUpdateDateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2021-02-04T15:36:52.7788848Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.errorHResult",
          "data_type": "numeric",
          "example_values": [
            0
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.index",
          "data_type": "numeric",
          "example_values": [
            0
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.startTime",
          "data_type": "string",
          "example_values": [
            "2023-02-06T17:19:52.7788848Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.endTime",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.commandStatus",
          "data_type": "string",
          "example_values": [
            "Created"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.errors.*",
          "data_type": "string",
          "example_values": [
            ""
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.type",
          "data_type": "string",
          "example_values": [
            "PutFile",
            "RunScript",
            "GetFile"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.params.*.key",
          "data_type": "string",
          "example_values": [
            "ScriptName",
            "Args",
            "path"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.params.*.value",
          "data_type": "string",
          "example_values": [
            "minidump.ps1",
            "OfficeClickToRun",
            "C:\\windows\\TEMP\\OfficeClickToRun.dmp.zip"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "list actions",
      "identifier": "list_actions",
      "description": "Retrieves a collection of Machine Actions.",
      "verbose": "<a class='external' href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-machineactions-collection' target='_blank'>Microsoft Docs - List MachineActions API</a>",
      "type": "information",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "filter": {
          "description": "filters to apply: (creationDateTimeUtc ge 2023-08-21T12:00:00Z and status eq 'Succeeded')",
          "data_type": "string",
          "required": false
        },
        "top": {
          "description": "limit results to the first x results with max value of 10,000",
          "data_type": "numeric",
          "required": false,
          "default": 10000
        },
        "skip": {
          "description": "skip the first x results",
          "data_type": "numeric",
          "required": false,
          "default": 0
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.*.id",
          "data_type": "string",
          "example_values": [
            "2e9da30d-27f6-4208-81f2-9cd3d67893ba"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.type",
          "data_type": "string",
          "example_values": [
            "RunAntiVirusScan"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.scope",
          "data_type": "string",
          "example_values": [
            "Full"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.requestor",
          "data_type": "string",
          "example_values": [
            "Analyst@contoso.com"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.requestorComment",
          "data_type": "string",
          "example_values": [
            "Check machine for viruses due to alert 3212"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.status",
          "data_type": "string",
          "example_values": [
            "Succeeded"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.machineId",
          "data_type": "string",
          "example_values": [
            "f46b9bb259ed4a7fb9981b73510e3cc7aa81ec1f"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.computerDnsName",
          "data_type": "string",
          "example_values": [
            "desktop-39g9tgl"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.creationDateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2018-12-04T12:18:27.1293487Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.lastUpdateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2018-12-04T12:18:57.5511934Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.relatedFileInfo.fileIdentifier",
          "data_type": "string",
          "example_values": [
            "a0c659857ccbe457fdaf5fe21d54efdcbf6f6508"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.relatedFileInfo.fileIdentifierType",
          "data_type": "string",
          "example_values": [
            "Sha1"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "get action",
      "identifier": "get_action",
      "description": "Retrieves specific Machine Action by its ID.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-machineaction-object' target='_blank'>Microsoft Docs - Get machineAction API</a>",
      "type": "forensic",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "action_id": {
          "description": "Action ID",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.id",
          "data_type": "string",
          "example_values": [
            "2e9da30d-27f6-4208-81f2-9cd3d67893ba"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.type",
          "data_type": "string",
          "example_values": [
            "RunAntiVirusScan"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.scope",
          "data_type": "string",
          "example_values": [
            "Full"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.requestor",
          "data_type": "string",
          "example_values": [
            "Analyst@contoso.com"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.requestorComment",
          "data_type": "string",
          "example_values": [
            "Check machine for viruses due to alert 3212"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.status",
          "data_type": "string",
          "example_values": [
            "Succeeded"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.machineId",
          "data_type": "string",
          "example_values": [
            "f46b9bb259ed4a7fb9981b73510e3cc7aa81ec1f"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.computerDnsName",
          "data_type": "string",
          "example_values": [
            "desktop-39g9tgl"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.creationDateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2018-12-04T12:18:27.1293487Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.lastUpdateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2018-12-04T12:18:57.5511934Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.relatedFileInfo.fileIdentifier",
          "data_type": "string",
          "example_values": [
            "a0c659857ccbe457fdaf5fe21d54efdcbf6f6508"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.relatedFileInfo.fileIdentifierType",
          "data_type": "string",
          "example_values": [
            "Sha1"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "get action result",
      "identifier": "get_action_result",
      "description": "Retrieves specific Machine Action by its ID.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-live-response-result' target='_blank'>Microsoft Docs - Get live response results</a>",
      "type": "forensic",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "action_id": {
          "description": "Action ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "command_index": {
          "description": "Command Index",
          "data_type": "numeric",
          "required": true,
          "primary": false
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.script_name",
          "data_type": "string",
          "example_values": [
            "minidump.ps1"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.exit_code",
          "data_type": "string",
          "example_values": [
            "0"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.script_output",
          "data_type": "string",
          "example_values": [
            "Transcript started, output file is C:\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection\\Temp\\PSScriptOutputs\\PSScript_Transcript_{TRANSCRIPT_ID}.txt\\nC:\\windows\\TEMP\\OfficeClickToRun.dmp.zip\n51 MB"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.script_errors",
          "data_type": "string",
          "example_values": [
            ""
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "list investigations",
      "identifier": "list_investigations",
      "description": "Retrieves a collection of Investigations.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-investigation-collection' target='_blank'>Microsoft Docs - List Investigations API</a>",
      "type": "investigative",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "filter": {
          "description": "filters to apply: (startTime ge 2023-08-21T12:00:00Z and state eq 'Succeeded')",
          "data_type": "string",
          "required": false
        },
        "top": {
          "description": "limit results to the first x results with max value of 10,000",
          "data_type": "numeric",
          "required": false,
          "default": 10000
        },
        "skip": {
          "description": "skip the first x results",
          "data_type": "numeric",
          "required": false,
          "default": 0
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.*.id",
          "data_type": "numeric",
          "example_values": [
            63017
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.startTime",
          "data_type": "string",
          "example_values": [
            "2020-01-06T14:11:34Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.endTime",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.state",
          "data_type": "string",
          "example_values": [
            "Running",
            "Benign"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.cancelledBy",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.statusDetails",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.machineId",
          "data_type": "string",
          "example_values": [
            "a69a22debe5f274d8765ea3c368d00762e057b30"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.computerDnsName",
          "data_type": "string",
          "example_values": [
            "desktop-gtrcon0"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.triggeringAlertId",
          "data_type": "string",
          "example_values": [
            "da637139166940871892_-598649278"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "get investigation",
      "identifier": "get_investigation",
      "description": "Retrieves specific Investigation by its ID.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-investigation-object' target='_blank'>Microsoft Docs - Get Investigation API</a>",
      "type": "investigative",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "investigation_id": {
          "description": "Investigation ID",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.id",
          "data_type": "numeric",
          "example_values": [
            63017
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.startTime",
          "data_type": "string",
          "example_values": [
            "2020-01-06T14:11:34Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.endTime",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.state",
          "data_type": "string",
          "example_values": [
            "Running"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.cancelledBy",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.statusDetails",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.machineId",
          "data_type": "string",
          "example_values": [
            "a69a22debe5f274d8765ea3c368d00762e057b30"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.computerDnsName",
          "data_type": "string",
          "example_values": [
            "desktop-gtrcon0"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.triggeringAlertId",
          "data_type": "string",
          "example_values": [
            "da637139166940871892_-598649278"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "start investigation",
      "identifier": "start_investigation",
      "description": "Start automated investigation on a device.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/initiate-autoir-investigation' target='_blank'>Microsoft Docs - Start Investigation API</a>",
      "type": "investigative",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "comment": {
          "description": "comment",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.id",
          "data_type": "numeric",
          "example_values": [
            63017
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.startTime",
          "data_type": "string",
          "example_values": [
            "2020-01-06T14:11:34Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.endTime",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.state",
          "data_type": "string",
          "example_values": [
            "Running"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.cancelledBy",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.statusDetails",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.machineId",
          "data_type": "string",
          "example_values": [
            "a69a22debe5f274d8765ea3c368d00762e057b30"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.computerDnsName",
          "data_type": "string",
          "example_values": [
            "desktop-gtrcon0"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.triggeringAlertId",
          "data_type": "string",
          "example_values": [
            "da637139166940871892_-598649278"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "collect investigation package",
      "identifier": "collect_investigation_package",
      "description": "Collect investigation package from a device.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/collect-investigation-package' target='_blank'>Microsoft Docs - Collect investigation package API</a>",
      "type": "forensic",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "comment": {
          "description": "comment",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.id",
          "data_type": "string",
          "example_values": [
            "d4390a5d-12c1-4735-be12-4c8a5724cdee"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.type",
          "data_type": "string",
          "example_values": [
            "CollectInvestigationPackage"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.title",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.requestor",
          "data_type": "string",
          "example_values": [
            ""
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.requestorComment",
          "data_type": "string",
          "example_values": [
            "Testing"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.status",
          "data_type": "string",
          "example_values": [
            "Pending"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.machineId",
          "data_type": "string",
          "example_values": [
            "943b78f183c4d61222c9af01190ab7388394f637"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.computerDnsName",
          "data_type": "string",
          "example_values": [
            "anzww-xl2112l9z.area52.afnoapps.usaf.mil my-computer.domain.com"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.creationDateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2023-09-15T19:04:19.8699263Z"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.lastUpdateDateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2023-09-15T19:04:19.8699269Z"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.cancellationRequestor",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.cancellationComment",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.cancellationDateTimeUtc",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.errorHResult",
          "data_type": "numeric",
          "example_values": [
            0
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.scope",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.externalId",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.requestSource",
          "data_type": "string",
          "example_values": [
            "PublicApi"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.relatedFileInfo",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.commands.*.index",
          "data_type": "numeric",
          "example_values": [
            0
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.startTime",
          "data_type": "string",
          "example_values": [
            "2023-02-06T17:19:52.7788848Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.endTime",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.commandStatus",
          "data_type": "string",
          "example_values": [
            "Created"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.errors.*",
          "data_type": "string",
          "example_values": [
            ""
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.type",
          "data_type": "string",
          "example_values": [
            "PutFile",
            "RunScript",
            "GetFile"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.params.*.key",
          "data_type": "string",
          "example_values": [
            "ScriptName",
            "Args",
            "path"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.params.*.value",
          "data_type": "string",
          "example_values": [
            "minidump.ps1",
            "OfficeClickToRun",
            "C:\\windows\\TEMP\\OfficeClickToRun.dmp.zip"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.troubleshootInfo",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": []
        }
      ]
    },
    {
      "action": "list machine actions",
      "identifier": "list_machine_actions",
      "description": "Retrieves a collection of Machine Actions.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-machineactions-collection' target='_blank'>Microsoft Docs - List MachineActions API</a>",
      "type": "information",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "filter": {
          "description": "filters to apply: (creationDateTimeUtc ge 2023-08-21T12:00:00Z and status eq 'Succeeded')",
          "data_type": "string",
          "required": false
        },
        "top": {
          "description": "limit results to the first x results with max value of 10,000",
          "data_type": "numeric",
          "required": false,
          "default": 10000
        },
        "skip": {
          "description": "skip the first x results",
          "data_type": "numeric",
          "required": false,
          "default": 0
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.id",
          "data_type": "string",
          "example_values": [
            "d4390a5d-12c1-4735-be12-4c8a5724cdee"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.type",
          "data_type": "string",
          "example_values": [
            "CollectInvestigationPackage"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.title",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.requestor",
          "data_type": "string",
          "example_values": [
            ""
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.requestorComment",
          "data_type": "string",
          "example_values": [
            "Testing"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.status",
          "data_type": "string",
          "example_values": [
            "Pending"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.machineId",
          "data_type": "string",
          "example_values": [
            "943b78f183c4d61222c9af01190ab7388394f637"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.computerDnsName",
          "data_type": "string",
          "example_values": [
            "anzww-xl2112l9z.area52.afnoapps.usaf.mil my-computer.domain.com"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.creationDateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2023-09-15T19:04:19.8699263Z"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.lastUpdateDateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2023-09-15T19:04:19.8699269Z"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.cancellationRequestor",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.cancellationComment",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.cancellationDateTimeUtc",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.errorHResult",
          "data_type": "numeric",
          "example_values": [
            0
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.scope",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.externalId",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.requestSource",
          "data_type": "string",
          "example_values": [
            "PublicApi"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.relatedFileInfo",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.commands.*.index",
          "data_type": "numeric",
          "example_values": [
            0
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.startTime",
          "data_type": "string",
          "example_values": [
            "2023-02-06T17:19:52.7788848Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.endTime",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.commandStatus",
          "data_type": "string",
          "example_values": [
            "Created"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.errors.*",
          "data_type": "string",
          "example_values": [
            ""
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.type",
          "data_type": "string",
          "example_values": [
            "PutFile",
            "RunScript",
            "GetFile"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.params.*.key",
          "data_type": "string",
          "example_values": [
            "ScriptName",
            "Args",
            "path"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.commands.*.params.*.value",
          "data_type": "string",
          "example_values": [
            "minidump.ps1",
            "OfficeClickToRun",
            "C:\\windows\\TEMP\\OfficeClickToRun.dmp.zip"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.troubleshootInfo",
          "data_type": "string",
          "example_values": [
            "null"
          ],
          "contains": []
        }
      ]
    },
    {
      "action": "isolate machine",
      "identifier": "isolate_machine",
      "description": "Isolates a device from accessing external network.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/isolate-machine' target='_blank'>Microsoft Docs - Isolate machine API\n</a>",
      "type": "endpoint",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.id",
          "data_type": "string",
          "example_values": [
            "2e9da30d-27f6-4208-81f2-9cd3d67893ba"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.type",
          "data_type": "string",
          "example_values": [
            "Isolate"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.scope",
          "data_type": "string",
          "example_values": [
            "Selective"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.requestor",
          "data_type": "string",
          "example_values": [
            "Analyst@contoso.com"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.requestorComment",
          "data_type": "string",
          "example_values": [
            "Check machine for viruses due to alert 3212"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.status",
          "data_type": "string",
          "example_values": [
            "Pending",
            "Succeeded"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.machineId",
          "data_type": "string",
          "example_values": [
            "f46b9bb259ed4a7fb9981b73510e3cc7aa81ec1f"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.computerDnsName",
          "data_type": "string",
          "example_values": [
            "desktop-39g9tgl"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.creationDateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2018-12-04T12:18:27.1293487Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.lastUpdateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2018-12-04T12:18:57.5511934Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.relatedFileInfo.fileIdentifier",
          "data_type": "string",
          "example_values": [
            "a0c659857ccbe457fdaf5fe21d54efdcbf6f6508"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.relatedFileInfo.fileIdentifierType",
          "data_type": "string",
          "example_values": [
            "Sha1"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "unisolate machine",
      "identifier": "unisolate_machine",
      "description": "Undo isolation of a device.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/unisolate-machine' target='_blank'>Microsoft Docs - Release device from isolation API\n</a>",
      "type": "endpoint",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.id",
          "data_type": "string",
          "example_values": [
            "2e9da30d-27f6-4208-81f2-9cd3d67893ba"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.type",
          "data_type": "string",
          "example_values": [
            "RunAntiVirusScan"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.scope",
          "data_type": "string",
          "example_values": [
            "Full"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.requestor",
          "data_type": "string",
          "example_values": [
            "Analyst@contoso.com"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.requestorComment",
          "data_type": "string",
          "example_values": [
            "Check machine for viruses due to alert 3212"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.status",
          "data_type": "string",
          "example_values": [
            "Succeeded"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.machineId",
          "data_type": "string",
          "example_values": [
            "f46b9bb259ed4a7fb9981b73510e3cc7aa81ec1f"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.computerDnsName",
          "data_type": "string",
          "example_values": [
            "desktop-39g9tgl"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.creationDateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2018-12-04T12:18:27.1293487Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.lastUpdateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2018-12-04T12:18:57.5511934Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.relatedFileInfo.fileIdentifier",
          "data_type": "string",
          "example_values": [
            "a0c659857ccbe457fdaf5fe21d54efdcbf6f6508"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.relatedFileInfo.fileIdentifierType",
          "data_type": "string",
          "example_values": [
            "Sha1"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "get file info",
      "identifier": "get_file_info",
      "description": "Retrieves a File by identifier Sha1, or Sha256.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-file-information' target='_blank'>Microsoft Docs - Get file information API</a>",
      "type": "reputation",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "file_hash": {
          "description": "file SHA1 or SHA256 hash",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.sha1",
          "data_type": "string",
          "example_values": [
            "4388963aaa83afe2042a46a3c017ad50bdcdafb3"
          ],
          "contains": [
            "Sha1"
          ]
        },
        {
          "data_path": "action_result.data.sha256",
          "data_type": "string",
          "example_values": [
            "413c58c8267d2c8648d8f6384bacc2ae9c929b2b96578b6860b5087cd1bd6462"
          ],
          "contains": [
            "Sha256"
          ]
        },
        {
          "data_path": "action_result.data.globalPrevalence",
          "data_type": "numeric",
          "example_values": [
            180022
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.globalFirstObserved",
          "data_type": "string",
          "example_values": [
            "2017-09-19T03:51:27.6785431Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.globalLastObserved",
          "data_type": "string",
          "example_values": [
            "2020-01-06T03:59:21.3229314Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.size",
          "data_type": "numeric",
          "example_values": [
            22139496
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.fileType",
          "data_type": "string",
          "example_values": [
            "APP"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.isPeFile",
          "data_type": "boolean",
          "example_values": [
            true,
            false
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.filePublisher",
          "data_type": "string",
          "example_values": [
            "CHENGDU YIWO Tech Development Co., Ltd."
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.fileProductName",
          "data_type": "string",
          "example_values": [
            "EaseUS MobiSaver for Android"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.signer",
          "data_type": "string",
          "example_values": [
            "CHENGDU YIWO Tech Development Co., Ltd."
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.issuer",
          "data_type": "string",
          "example_values": [
            "VeriSign Class 3 Code Signing 2010 CA"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.signerHash",
          "data_type": "string",
          "example_values": [
            "6c3245d4a9bc0244d99dff27af259cbbae2e2d16"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.isValidCertificate",
          "data_type": "boolean",
          "example_values": [
            true,
            false
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.determinationType",
          "data_type": "string",
          "example_values": [
            "Pua"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.determinationValue",
          "data_type": "string",
          "example_values": [
            "PUA:Win32/FusionCore"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "get file stats",
      "identifier": "get_file_stats",
      "description": "Retrieves the statistics for the given file.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-file-statistics' target='_blank'>Microsoft Docs - Get file statistics API</a>",
      "type": "information",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "file_hash": {
          "description": "file SHA1 or SHA256 hash",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "look_back_hours": {
          "description": "Defines the hours we search back to get the statistics.",
          "data_type": "numeric",
          "required": false,
          "primary": false,
          "default": 720
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.sha1",
          "data_type": "string",
          "example_values": [
            "0991a395da64e1c5fbe8732ed11e6be064081d9f"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.organizationPrevalence",
          "data_type": "numeric",
          "example_values": [
            14850
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.orgFirstSeen",
          "data_type": "string",
          "example_values": [
            "2019-12-07T13:44:16Z"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.orgLastSeen",
          "data_type": "string",
          "example_values": [
            "2020-01-06T13:39:36Z"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.globallyPrevalence",
          "data_type": "numeric",
          "example_values": [
            705012
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.globalFirstObserved",
          "data_type": "string",
          "example_values": [
            "2015-03-19T12:20:07.3432441Z"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.globalLastObserved",
          "data_type": "string",
          "example_values": [
            "2020-01-06T13:39:36Z"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.topFileNames.*",
          "data_type": "string",
          "example_values": [
            "MREC.exe"
          ],
          "contains": []
        }
      ]
    },
    {
      "action": "quarantine file",
      "identifier": "quarantine_file",
      "description": "Stop execution of a file on a device and delete it.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/stop-and-quarantine-file' target='_blank'>Microsoft Docs - Stop and quarantine file API</a>",
      "type": "endpoint",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "sha1_hash": {
          "description": "file SHA1 hash",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "comment": {
          "description": "comment",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {
      },
      "output": [
        {
          "data_path": "action_result.data.id",
          "data_type": "string",
          "example_values": [
            "2e9da30d-27f6-4208-81f2-9cd3d67893ba"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.type",
          "data_type": "string",
          "example_values": [
            "RunAntiVirusScan"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.scope",
          "data_type": "string",
          "example_values": [
            "Full"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.requestor",
          "data_type": "string",
          "example_values": [
            "Analyst@contoso.com"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.requestorComment",
          "data_type": "string",
          "example_values": [
            "Check machine for viruses due to alert 3212"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.status",
          "data_type": "string",
          "example_values": [
            "Succeeded"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.machineId",
          "data_type": "string",
          "example_values": [
            "f46b9bb259ed4a7fb9981b73510e3cc7aa81ec1f"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.computerDnsName",
          "data_type": "string",
          "example_values": [
            "desktop-39g9tgl"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.creationDateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2018-12-04T12:18:27.1293487Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.lastUpdateTimeUtc",
          "data_type": "string",
          "example_values": [
            "2018-12-04T12:18:57.5511934Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.relatedFileInfo.fileIdentifier",
          "data_type": "string",
          "example_values": [
            "a0c659857ccbe457fdaf5fe21d54efdcbf6f6508"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.relatedFileInfo.fileIdentifierType",
          "data_type": "string",
          "example_values": [
            "Sha1"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "on poll",
      "identifier": "on_poll",
      "description": "Ingest data from MDE.",
      "verbose": "",
      "type": "information",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {},
      "render": {},
      "output": []
    },
    {
      "action": "widget update",
      "identifier": "widget_update",
      "description": "Create or update a container's widget.",
      "verbose": "",
      "type": "informational",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "incident_id": {
          "description": "Incident ID",
          "data_type": "string",
          "required": true,
          "primary": true
        }
      },
      "render": {
        "type": "table",
        "width": 2,
        "height": 5,
        "title": "TITLE_GOES_HERE",
        "menu_name": "menu_name"
      },
      "output": [
        {
          "data_path": "action_result.data.alert.*.alert_link",
          "data_type": "string",
          "example_values": [],
          "contains": [
            "url"
          ],
          "column_name": "Alert Link",
          "column_order": 0
        }
      ]
    }
  ]
}
