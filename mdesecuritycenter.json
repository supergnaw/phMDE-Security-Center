{
  "appid": "14b2b770-93ca-4684-b41e-d585f8466a61",
  "name": "MDE Security Center",
  "description": "Splunk SOAR connector module for interacting with the Microsoft Defender for Endpoint Security Center API.",
  "type": "endpoint",
  "main_module": "mdesecuritycenter_connector.py",
  "app_version": "1.0.0",
  "product_vendor": "Microsoft",
  "product_name": "Microsoft 365 Defender for Endpoint",
  "product_version_regex": ".*",
  "publisher": "Supernawesome L.L.C.",
  "package_name": "phantom_mdesecuritycenter",
  "license": "GNU General Public License v3.0",
  "consolidate_widgets": true,
  "url": "https://github.com/supergnaw/phMDE-Security-Center",
  "logo": "logo_mdesecuritycenter.svg",
  "logo_dark": "logo_mdesecuritycenter_dark.svg",
  "python_version": "3",
  "utctime_updated": "2022-05-26T06:24:07.659521Z",
  "min_phantom_version": "5.3.0",
  "latest_tested_versions": [
    "*.securitycenter.microsoft.com/test, 10 Aug 2023"
  ],
  "fips_compliant": true,
  "configuration": {
    "tenant_id": {
      "data_type": "string",
      "description": "Tenant ID",
      "required": true,
      "order": 0
    },
    "ph1": {
      "data_type": "ph",
      "order": 1
    },
    "client_id": {
      "data_type": "string",
      "description": "Client ID",
      "required": true,
      "order": 2
    },
    "client_secret": {
      "data_type": "password",
      "description": "Client Secret",
      "required": true,
      "order": 3
    },
    "ph2": {
      "data_type": "ph",
      "order": 4
    },
    "api_uri": {
      "data_type": "string",
      "description": "API Endpoint Server URI",
      "required": true,
      "value_list": [
        "https://api-eu.*.microsoft.com",
        "https://api-gcc.*.microsoft.us",
        "https://api-gov.*.microsoft.us",
        "https://api-uk.*.microsoft.com",
        "https://api-us.*.microsoft.com"
      ],
      "default": "https://api-us.*.microsoft.com",
      "order": 5
    }
  },
  "actions": [
    {
      "action": "test connectivity",
      "identifier": "test_connectivity",
      "description": "Verifies app connection with MDE.",
      "verbose": "Validates the asset configuration for connectivity using the supplied configuration and displays summaries of all authentication tokens",
      "type": "test",
      "read_only": true,
      "parameters": {
        "force_refresh": {
          "description": "Remove cached tokens and revalidate credentials.",
          "data_type": "boolean",
          "required": false
        }
      },
      "output": [],
      "versions": "EQ(*)"
    },
    {
      "action": "list incidents",
      "identifier": "list_incidents",
      "description": "Retrieves a collection of Incidents.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender/api-list-incidents' target='_blank'>Microsoft Docs - List incidents API in Microsoft 365 Defender</a>",
      "type": "information",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "filter": {
          "description": "filters to apply: (createdTime ge 2023-08-21T12:00:00Z and status eq 'active')",
          "data_type": "string",
          "required": false
        },
        "top": {
          "description": "limit results to the top x results",
          "data_type": "numeric",
          "required": false,
          "default": 1000
        },
        "skip": {
          "description": "skip the first x results",
          "data_type": "numeric",
          "required": false,
          "default": 0
        }
      },
      "render": {},
      "output": [
        {
          "data_path": "action_result.data.*.source_data_identifier",
          "data_type": "string",
          "example_values": [
            "c55942da-f4c0-49ca-8fe9-1aeda73df676"
          ],
          "contains": [
            "uuid"
          ]
        },
        {
          "data_path": "action_result.data.*.incidentId",
          "data_type": "numeric",
          "example_values": [
            68594,
            12345,
            54321
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.incidentUri",
          "data_type": "string",
          "example_values": [],
          "contains": [
            "url"
          ]
        },
        {
          "data_path": "action_result.data.*.redirectIncidentId",
          "data_type": "string",
          "example_values": [
            "None"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.incidentName",
          "data_type": "string",
          "example_values": [
            "Suspicious activity"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.createdTime",
          "data_type": "string",
          "example_values": [
            "2023-08-21T18:02:40.84Z"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.lastUpdateTime",
          "data_type": "string",
          "example_values": [
            "2023-08-21T18:02:46.3Z"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.assignedTo",
          "data_type": "string",
          "example_values": [
            "None",
            "user@email.com"
          ],
          "contains": [
            "email"
          ]
        },
        {
          "data_path": "action_result.data.*.classification",
          "data_type": "string",
          "example_values": [
            "Unknown"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.determination",
          "data_type": "string",
          "example_values": [
            "NotAvailable"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.detectionSource",
          "data_type": "string",
          "example_values": [
            "Defender for Cloud Apps"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.status",
          "data_type": "string",
          "example_values": [
            "Active"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.severity",
          "data_type": "string",
          "example_values": [
            "Low","Medium"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.tags.*",
          "data_type": "string",
          "example_values": [
            "tag a", "Tag B"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.comments.*",
          "data_type": "string",
          "example_values": [
            "Interesting comment goes here."
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.source_data_identifier",
          "data_type": "string",
          "example_values": [
            "53347d49-f83e-4569-9866-86f62977986b"
          ],
          "contains": [
            "uuid"
          ]
        },
        {
          "data_path": "action_result.data.*.alerts.*.alertId",
          "data_type": "string",
          "example_values": [
            "caD70CFEE2-1F54-32DB-9988-3A868A1EBFAC"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.providerAlertId",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.incidentId",
          "data_type": "numeric",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.serviceSource",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.creationTime",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.lastUpdatedTime",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.resolvedTime",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.firstActivity",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.lastActivity",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.title",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.description",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.category",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.status",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.severity",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.investigationId",
          "data_type": "numeric",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.investigationState",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.classification",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.determination",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.detectionSource",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.detectorId",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.assignedTo",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.actorName",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.threatFamilyName",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.mitreTechniques",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.mdatpDeviceId",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.aadDeviceId",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.deviceDnsName",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.osPlatform",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.version",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.osProcessor",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.osBuild",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.healthStatus",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.riskScore",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.rbacGroupName",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.firstSeen",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.tags.*",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.defenderAvStatus",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.onboardingStatus",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.vmMetadata",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.loggedOnUsers.*.accountName",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.devices.*.loggedOnUsers.*.domainName",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.entityType",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.sha1",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.sha256",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.fileName",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.filePath",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.processId",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.processCommandLine",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.processCreationTime",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.parentProcessId",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.parentProcessCreationTime",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.ipAddress",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.url",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.accountName",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.domainName",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.userSid",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.aadUserId",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.userPrincipalName",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.mailboxDisplayName",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.mailboxAddress",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.clusterBy",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.sender",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.recipient",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.subject",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.deliveryAction",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.securityGroupId",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.securityGroupName",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.registryHive",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.registryKey",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.registryValueType",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.registryValue",
          "data_type": "string",
          "example_values": [],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.alerts.*.entities.*.deviceId",
          "data_type": "string",
          "example_values": [],
          "contains": []
        }
      ]
    },
    {
      "action": "get incident",
      "identifier": "get_incident",
      "description": "Retrieves a specific incident by its ID.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender/api-get-incident' target='_blank'>Microsoft Docs - Get incident information API</a>",
      "type": "information",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "incident_id": {
          "description": "Incident ID",
          "data_type": "numeric",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": [
        {
          "data_path": "action_result.data.*.status",
          "data_type": "string",
          "example_values": [
            "Active"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.severity",
          "data_type": "string",
          "example_values": [
            "Low"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.assignedTo",
          "data_type": "string",
          "example_values": [
            "None",
            "user@email.com"
          ],
          "contains": [
            "email"
          ]
        },
        {
          "data_path": "action_result.data.*.incidentId",
          "data_type": "numeric",
          "example_values": [
            68594,
            12345,
            54321
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.createdTime",
          "data_type": "string",
          "example_values": [
            "2023-08-21T18:02:40.84Z"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.incidentUri",
          "data_type": "string",
          "example_values": [],
          "contains": [
            "url"
          ]
        },
        {
          "data_path": "action_result.data.*.incidentName",
          "data_type": "string",
          "example_values": [
            "Suspicious activity"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.determination",
          "data_type": "string",
          "example_values": [
            "NotAvailable"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.classification",
          "data_type": "string",
          "example_values": [
            "Unknown"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.lastUpdateTime",
          "data_type": "string",
          "example_values": [
            "2023-08-21T18:02:46.3Z"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.*.redirectIncidentId",
          "data_type": "string",
          "example_values": [
            "None"
          ],
          "contains": []
        }
      ]
    },
    {
      "action": "update incident",
      "identifier": "update_incident",
      "description": "Updates properties of existing incident.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender/api-update-incidents' target='_blank'>Microsoft Docs - Update incidents API</a>",
      "type": "investigative",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "incident_id": {
          "description": "Incident ID",
          "data_type": "numeric",
          "required": true,
          "primary": false
        },
        "status": {
          "description": "Specifies the current status of the incident",
          "data_type": "string",
          "required": true,
          "primary": false,
          "value_list": [
            "No Change",
            "Active",
            "Resolved",
            "Redirected"
          ],
          "default": "No Change"
        },
        "assigned_to": {
          "description": "Owner of the incident",
          "data_type": "string",
          "required": false,
          "primary": false
        },
        "category": {
          "description": "Classification and determination of the incident",
          "data_type": "string",
          "required": false,
          "primary": false,
          "value_list": [
            "No Change",
            "Informational: Security test",
            "Informational: Line-of-business application",
            "Informational: Confirmed activity",
            "Informational: Other",
            "False positive: Not malicious",
            "False positive: Not enough data to validate",
            "False positive: Other",
            "True positive: Multistage attack",
            "True positive: Malicious user activity",
            "True positive: Compromised account",
            "True positive: Malware",
            "True positive: Phishing",
            "True positive: Unwanted software",
            "True positive: Other"
          ],
          "default": "No Change"
        },
        "tags": {
          "description": "List of incident tags",
          "data_type": "string",
          "required": false,
          "primary": false,
          "allow_list": true
        },
        "remove_tags": {
          "description": "Remove existing incident tags",
          "data_type": "boolean",
          "required": false
        },
        "comment": {
          "description": "Comment to be added to the incident",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": [
        {
          "data_path": "action_result.data.status",
          "data_type": "string",
          "example_values": [
            "Resolved", "Active"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.assignedTo",
          "data_type": "string",
          "example_values": [
            "secop2@contoso.com"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.classification",
          "data_type": "string",
          "example_values": [
            "TruePositive"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.determination",
          "data_type": "string",
          "example_values": [
            "Malware"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.tags.*",
          "data_type": "string",
          "example_values": [
            "Yossi's playground", "Don't mess with the Zohan"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.comments.*.comment",
          "data_type": "string",
          "example_values": [
            "pen testing", "valid incident"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.comments.*.createdBy",
          "data_type": "string",
          "example_values": [
            "secop2@contoso.com"
          ],
          "contains": []
        },
        {
          "data_path": "action_result.data.comments.*.createdTime",
          "data_type": "string",
          "example_values": [
            "2021-05-02T09:34:21.5519738Z", "2021-05-02-T09:36:27.6652581Z"
          ],
          "contains": []
        }
      ]
    },
    {
      "action": "list alerts",
      "identifier": "list_alerts",
      "description": "Retrieves a collection of Alerts.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-alerts' target='_blank'>Microsoft Docs - List alerts API</a>",
      "type": "informational",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {},
      "render": {},
      "output": []
    },
    {
      "action": "get alert",
      "identifier": "get_alert",
      "description": "Retrieves specific Alert by its ID.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-alert-info-by-id' target='_blank'>Microsoft Docs - Get alert information by ID API</a>",
      "type": "informational",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "alert_id": {
          "description": "Alert ID",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "update alert",
      "identifier": "update_alert",
      "description": "Updates properties of existing Alert.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/update-alert' target='_blank'>Microsoft Docs - Update alert</a>",
      "type": "investigative",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "alert_id": {
          "description": "Alert ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "status": {
          "description": "Specifies the current status of the incident",
          "data_type": "string",
          "required": true,
          "primary": false,
          "value_list": [
            "No Change",
            "Active",
            "Resolved",
            "Redirected"
          ],
          "default": "No Change"
        },
        "assigned_to": {
          "description": "Owner of the incident",
          "data_type": "string",
          "required": false,
          "primary": false
        },
        "category": {
          "description": "Classification and determination of the incident",
          "data_type": "string",
          "required": false,
          "primary": false,
          "value_list": [
            "No Change",
            "Informational: Security test",
            "Informational: Line-of-business application",
            "Informational: Confirmed activity",
            "Informational: Other",
            "False positive: Not malicious",
            "False positive: Not enough data to validate",
            "False positive: Other",
            "True positive: Multistage attack",
            "True positive: Malicious user activity",
            "True positive: Compromised account",
            "True positive: Malware",
            "True positive: Phishing",
            "True positive: Unwanted software",
            "True positive: Other"
          ],
          "default": "No Change"
        },
        "comment": {
          "description": "Comment to be added to the incident",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "update alert batch",
      "identifier": "update_alert_batch",
      "description": "Updates properties of a batch of existing Alerts.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/batch-update-alerts' target='_blank'>Microsoft Docs - Batch update alerts</a>",
      "type": "investigative",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "alert_list": {
          "description": "Alert ID List",
          "data_type": "string",
          "required": true,
          "primary": false,
          "allow_list": true
        },
        "status": {
          "description": "Specifies the current status of the incident",
          "data_type": "string",
          "required": true,
          "primary": false,
          "value_list": [
            "No Change",
            "Active",
            "Resolved",
            "Redirected"
          ],
          "default": "No Change"
        },
        "assigned_to": {
          "description": "Owner of the incident",
          "data_type": "string",
          "required": false,
          "primary": false
        },
        "category": {
          "description": "Classification and determination of the incident",
          "data_type": "string",
          "required": false,
          "primary": false,
          "value_list": [
            "No Change",
            "Informational: Security test",
            "Informational: Line-of-business application",
            "Informational: Confirmed activity",
            "Informational: Other",
            "False positive: Not malicious",
            "False positive: Not enough data to validate",
            "False positive: Other",
            "True positive: Multistage attack",
            "True positive: Malicious user activity",
            "True positive: Compromised account",
            "True positive: Malware",
            "True positive: Phishing",
            "True positive: Unwanted software",
            "True positive: Other"
          ],
          "default": "No Change"
        },
        "comment": {
          "description": "Comment to be added to the incident",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "list alert files",
      "identifier": "list_alert_files",
      "description": "Retrieves all files related to a specific alert.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-alert-related-files-info' target='_blank'>Microsoft Docs - Get alert related files information API</a>",
      "type": "investigative",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "alert_id": {
          "description": "Alert ID",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "list library scripts",
      "identifier": "list_library_scripts",
      "description": "List live response library files.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/list-library-files' target='_blank'>Microsoft Docs - List library files</a>",
      "type": "forensic",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {},
      "render": {},
      "output": []
    },
    {
      "action": "run actions",
      "identifier": "run_actions",
      "description": "Runs a sequence of live response commands on a device.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/run-live-response' target='_blank'>Microsoft Docs - Run live response commands on a device</a>",
      "type": "forensic",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "action_commands": {
          "description": "Action commands",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "run action",
      "identifier": "run_action",
      "description": "Runs a single live response commands on a device.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/run-live-response' target='_blank'>Microsoft Docs - Run live response commands on a device</a>",
      "type": "forensic",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "command_type": {
          "description": "Command Type",
          "data_type": "string",
          "required": true,
          "primary": false,
          "value_list": [
            "PutFile",
            "RunScript",
            "GetFile"
          ]
        },
        "file_name": {
          "description": "File Name/Script Name/Path",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "arguments": {
          "description": "Script arguments, if any",
          "data_type": "string",
          "required": false,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "list actions",
      "identifier": "list_actions",
      "description": "Retrieves a collection of Machine Actions.",
      "verbose": "<a class='external' href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-machineactions-collection' target='_blank'>Microsoft Docs - List MachineActions API</a>",
      "type": "information",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "filter": {
          "description": "filters to apply: (creationDateTimeUtc ge 2023-08-21T12:00:00Z and status eq 'Succeeded')",
          "data_type": "string",
          "required": false
        },
        "top": {
          "description": "limit results to the first x results with max value of 10,000",
          "data_type": "numeric",
          "required": false,
          "default": 10000
        },
        "skip": {
          "description": "skip the first x results",
          "data_type": "numeric",
          "required": false,
          "default": 0
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "get action",
      "identifier": "get_action",
      "description": "Retrieves specific Machine Action by its ID.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-machineaction-object' target='_blank'>Microsoft Docs - Get machineAction API</a>",
      "type": "forensic",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "action_id": {
          "description": "Action ID",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "get action result",
      "identifier": "get_action_result",
      "description": "Retrieves specific Machine Action by its ID.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-live-response-result' target='_blank'>Microsoft Docs - Get live response results</a>",
      "type": "forensic",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "action_id": {
          "description": "Action ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "command_index": {
          "description": "Command Index",
          "data_type": "numeric",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "list investigations",
      "identifier": "list_investigations",
      "description": "Retrieves a collection of Investigations.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-investigation-collection' target='_blank'>Microsoft Docs - List Investigations API</a>",
      "type": "investigative",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "filter": {
          "description": "filters to apply: (startTime ge 2023-08-21T12:00:00Z and state eq 'Succeeded')",
          "data_type": "string",
          "required": false
        },
        "top": {
          "description": "limit results to the first x results with max value of 10,000",
          "data_type": "numeric",
          "required": false,
          "default": 10000
        },
        "skip": {
          "description": "skip the first x results",
          "data_type": "numeric",
          "required": false,
          "default": 0
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "get investigation",
      "identifier": "get_investigation",
      "description": "Retrieves specific Investigation by its ID.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-investigation-object' target='_blank'>Microsoft Docs - Get Investigation API</a>",
      "type": "investigative",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "investigation_id": {
          "description": "Investigation ID",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "start investigation",
      "identifier": "start_investigation",
      "description": "Start automated investigation on a device.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/initiate-autoir-investigation' target='_blank'>Microsoft Docs - Start Investigation API</a>",
      "type": "investigative",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "comment": {
          "description": "comment",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "collect investigation package",
      "identifier": "collect_investigation_package",
      "description": "Collect investigation package from a device.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/collect-investigation-package' target='_blank'>Microsoft Docs - Collect investigation package API</a>",
      "type": "forensic",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "comment": {
          "description": "comment",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "list machine actions",
      "identifier": "list_machine_actions",
      "description": "Retrieves a collection of Machine Actions.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-machineactions-collection' target='_blank'>Microsoft Docs - List MachineActions API</a>",
      "type": "information",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "filter": {
          "description": "filters to apply: (creationDateTimeUtc ge 2023-08-21T12:00:00Z and status eq 'Succeeded')",
          "data_type": "string",
          "required": false
        },
        "top": {
          "description": "limit results to the first x results with max value of 10,000",
          "data_type": "numeric",
          "required": false,
          "default": 10000
        },
        "skip": {
          "description": "skip the first x results",
          "data_type": "numeric",
          "required": false,
          "default": 0
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "isolate machine",
      "identifier": "isolate_machine",
      "description": "Isolates a device from accessing external network.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/isolate-machine' target='_blank'>Microsoft Docs - Isolate machine API\n</a>",
      "type": "endpoint",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "unisolate machine",
      "identifier": "unisolate_machine",
      "description": "Undo isolation of a device.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/unisolate-machine' target='_blank'>Microsoft Docs - Release device from isolation API\n</a>",
      "type": "endpoint",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "get file info",
      "identifier": "get_file_info",
      "description": "Retrieves a File by identifier Sha1, or Sha256.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-file-information' target='_blank'>Microsoft Docs - Get file information API</a>",
      "type": "reputation",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "file_hash": {
          "description": "file SHA1 or SHA256 hash",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "get file stats",
      "identifier": "get_file_stats",
      "description": "Retrieves the statistics for the given file.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-file-statistics' target='_blank'>Microsoft Docs - Get file statistics API</a>",
      "type": "information",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "file_hash": {
          "description": "file SHA1 or SHA256 hash",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "look_back_hours": {
          "description": "Defines the hours we search back to get the statistics.",
          "data_type": "numeric",
          "required": false,
          "primary": false,
          "default": 720
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "quarantine file",
      "identifier": "quarantine_file",
      "description": "Stop execution of a file on a device and delete it.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/stop-and-quarantine-file' target='_blank'>Microsoft Docs - Stop and quarantine file API</a>",
      "type": "endpoint",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "sha1_hash": {
          "description": "file SHA1 hash",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "comment": {
          "description": "comment",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    }
  ]
}