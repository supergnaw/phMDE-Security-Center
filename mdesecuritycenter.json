{
  "appid": "14b2b770-93ca-4684-b41e-d585f8466a61",
  "name": "MDE Security Center",
  "description": "Splunk SOAR connector module for interacting with the Microsoft Defender for Endpoint Security Center API.",
  "type": "endpoint",
  "main_module": "mdesecuritycenter_connector.py",
  "app_version": "1.0.0",
  "product_vendor": "Microsoft",
  "product_name": "Microsoft 365 Defender for Endpoint",
  "product_version_regex": ".*",
  "publisher": "Supernawesome L.L.C.",
  "package_name": "phantom_mdesecuritycenter",
  "license": "GNU General Public License v3.0",
  "consolidate_widgets": true,
  "url": "https://github.com/supergnaw/phMDE-Security-Center",
  "logo": "logo_mdesecuritycenter.svg",
  "logo_dark": "logo_mdesecuritycenter_dark.svg",
  "python_version": "3",
  "utctime_updated": "2022-05-26T06:24:07.659521Z",
  "min_phantom_version": "5.3.0",
  "latest_tested_versions": [
    "*.securitycenter.microsoft.com/test, 10 Aug 2023"
  ],
  "fips_compliant": true,
  "configuration": {
    "tenant_id": {
      "data_type": "string",
      "description": "Tenant ID",
      "required": true,
      "order": 0
    },
    "ph1": {
      "data_type": "ph",
      "order": 1
    },
    "client_id": {
      "data_type": "string",
      "description": "Client ID",
      "required": true,
      "order": 2
    },
    "client_secret": {
      "data_type": "password",
      "description": "Client Secret",
      "required": true,
      "order": 3
    },
    "ph2": {
      "data_type": "ph",
      "order": 4
    },
    "api_uri": {
      "data_type": "string",
      "description": "API Endpoint Server URI",
      "required": true,
      "value_list": [
        "https://api-eu.*.microsoft.com",
        "https://api-gcc.*.microsoft.us",
        "https://api-gov.*.microsoft.us",
        "https://api-uk.*.microsoft.com",
        "https://api-us.*.microsoft.com"
      ],
      "default": "https://api-us.*.microsoft.com",
      "order": 5
    }
  },
  "actions": [
    {
      "action": "test connectivity",
      "identifier": "test_connectivity",
      "description": "Verifies app connection with MDE.",
      "verbose": "Validates the asset configuration for connectivity using the supplied configuration and displays summaries of all authentication tokens",
      "type": "test",
      "read_only": true,
      "parameters": {},
      "output": [],
      "versions": "EQ(*)"
    },
    {
      "action": "list incidents",
      "identifier": "list_incidents",
      "description": "Retrieves a collection of Incidents.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender/api-list-incidents?view=o365-worldwide' target='_blank'>Microsoft Docs - List incidents API in Microsoft 365 Defender</a>",
      "type": "information",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "filter": {
          "description": "filters to apply: (createdTime ge 2023-08-21T12:00:00Z and status eq 'active')",
          "data_type": "string",
          "required": false
        },
        "top": {
          "description": "limit results to the top x results",
          "data_type": "numeric",
          "required": false,
          "default": 1000
        },
        "skip": {
          "description": "skip the first x results",
          "data_type": "numeric",
          "required": false,
          "default": 0
        }
      },
      "render": {},
      "output": [
        {
          "data_path": "action_result.data.*.status",
          "data_type": "string",
          "example_values": [
            "Active"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.severity",
          "data_type": "string",
          "example_values": [
            "Low"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.assignedTo",
          "data_type": "string",
          "example_values": [
            "None",
            "user@email.com"
          ],
          "contains": [
            "email"
          ]
        },
        {
          "data_path": "action_result.data.*.incidentId",
          "data_type": "numeric",
          "example_values": [
            68594,
            12345,
            54321
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.createdTime",
          "data_type": "string",
          "example_values": [
            "2023-08-21T18:02:40.84Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.incidentUri",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
            "url"
          ]
        },
        {
          "data_path": "action_result.data.*.incidentName",
          "data_type": "string",
          "example_values": [
            "Suspicious activity"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.determination",
          "data_type": "string",
          "example_values": [
            "NotAvailable"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.classification",
          "data_type": "string",
          "example_values": [
            "Unknown"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.lastUpdateTime",
          "data_type": "string",
          "example_values": [
            "2023-08-21T18:02:46.3Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.redirectIncidentId",
          "data_type": "string",
          "example_values": [
            "None"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "get incident",
      "identifier": "get_incident",
      "description": "Retrieves a specific incident by its ID.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender/api-get-incident?view=o365-worldwide' target='_blank'>Microsoft Docs - Get incident information API</a>",
      "type": "information",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "incident_id": {
          "description": "Incident ID",
          "data_type": "numeric",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": [
        {
          "data_path": "action_result.data.*.status",
          "data_type": "string",
          "example_values": [
            "Active"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.severity",
          "data_type": "string",
          "example_values": [
            "Low"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.assignedTo",
          "data_type": "string",
          "example_values": [
            "None",
            "user@email.com"
          ],
          "contains": [
            "email"
          ]
        },
        {
          "data_path": "action_result.data.*.incidentId",
          "data_type": "numeric",
          "example_values": [
            68594,
            12345,
            54321
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.createdTime",
          "data_type": "string",
          "example_values": [
            "2023-08-21T18:02:40.84Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.incidentUri",
          "data_type": "string",
          "example_values": [
          ],
          "contains": [
            "url"
          ]
        },
        {
          "data_path": "action_result.data.*.incidentName",
          "data_type": "string",
          "example_values": [
            "Suspicious activity"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.determination",
          "data_type": "string",
          "example_values": [
            "NotAvailable"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.classification",
          "data_type": "string",
          "example_values": [
            "Unknown"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.lastUpdateTime",
          "data_type": "string",
          "example_values": [
            "2023-08-21T18:02:46.3Z"
          ],
          "contains": [
          ]
        },
        {
          "data_path": "action_result.data.*.redirectIncidentId",
          "data_type": "string",
          "example_values": [
            "None"
          ],
          "contains": [
          ]
        }
      ]
    },
    {
      "action": "update incident",
      "identifier": "update_incident",
      "description": "Updates properties of existing incident.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender/api-update-incidents?view=o365-worldwide' target='_blank'>Microsoft Docs - Update incidents API</a>",
      "type": "investigative",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "incident_id": {
          "description": "Incident ID",
          "data_type": "numeric",
          "required": true,
          "primary": false
        },
        "status": {
          "description": "Specifies the current status of the incident",
          "data_type": "string",
          "required": true,
          "primary": false,
          "value_list": [
            "No Change",
            "Active",
            "Resolved",
            "Redirected"
          ],
          "default": "No Change"
        },
        "assigned_to": {
          "description": "Owner of the incident",
          "data_type": "string",
          "required": false,
          "primary": false
        },
        "category": {
          "description": "Classification and determination of the incident",
          "data_type": "string",
          "required": false,
          "primary": false,
          "value_list": [
            "No Change",
            "Informational: Security test",
            "Informational: Line-of-business application",
            "Informational: Confirmed activity",
            "Informational: Other",
            "False positive: Not malicious",
            "False positive: Not enough data to validate",
            "False positive: Other",
            "True positive: Multistage attack",
            "True positive: Malicious user activity",
            "True positive: Compromised account",
            "True positive: Malware",
            "True positive: Phishing",
            "True positive: Unwanted software",
            "True positive: Other"
          ],
          "default": "No Change"
        },
        "tags": {
          "description": "List of incident tags",
          "data_type": "string",
          "required": false,
          "primary": false,
          "allow_list": true
        },
        "remove_tags": {
          "description": "Remove existing incident tags",
          "data_type": "boolean",
          "required": false
        },
        "comment": {
          "description": "Comment to be added to the incident",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "list alerts",
      "identifier": "list_alerts",
      "description": "Retrieves a collection of Alerts.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-alerts?view=o365-worldwide' target='_blank'>Microsoft Docs - List alerts API</a>",
      "type": "informational",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {},
      "render": {},
      "output": []
    },
    {
      "action": "get alert",
      "identifier": "get_alert",
      "description": "Retrieves specific Alert by its ID.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-alert-info-by-id?view=o365-worldwide' target='_blank'>Microsoft Docs - Get alert information by ID API</a>",
      "type": "informational",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "alert_id": {
          "description": "Alert ID",
          "data_type": "numeric",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "update alert",
      "identifier": "update_alert",
      "description": "Updates properties of existing Alert.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/update-alert?view=o365-worldwide' target='_blank'>Microsoft Docs - Update alert</a>",
      "type": "investigative",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "alert_id": {
          "description": "Alert ID",
          "data_type": "numeric",
          "required": true,
          "primary": false
        },
        "status": {
          "description": "Specifies the current status of the incident",
          "data_type": "string",
          "required": true,
          "primary": false,
          "value_list": [
            "No Change",
            "Active",
            "Resolved",
            "Redirected"
          ],
          "default": "No Change"
        },
        "assigned_to": {
          "description": "Owner of the incident",
          "data_type": "string",
          "required": false,
          "primary": false
        },
        "category": {
          "description": "Classification and determination of the incident",
          "data_type": "string",
          "required": false,
          "primary": false,
          "value_list": [
            "No Change",
            "Informational: Security test",
            "Informational: Line-of-business application",
            "Informational: Confirmed activity",
            "Informational: Other",
            "False positive: Not malicious",
            "False positive: Not enough data to validate",
            "False positive: Other",
            "True positive: Multistage attack",
            "True positive: Malicious user activity",
            "True positive: Compromised account",
            "True positive: Malware",
            "True positive: Phishing",
            "True positive: Unwanted software",
            "True positive: Other"
          ],
          "default": "No Change"
        },
        "comment": {
          "description": "Comment to be added to the incident",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "update alert batch",
      "identifier": "update_alert_batch",
      "description": "Updates properties of a batch of existing Alerts.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/batch-update-alerts?view=o365-worldwide' target='_blank'>Microsoft Docs - Batch update alerts</a>",
      "type": "investigative",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "alert_list": {
          "description": "Alert ID List",
          "data_type": "string",
          "required": true,
          "primary": false,
          "allow_list": true
        },
        "status": {
          "description": "Specifies the current status of the incident",
          "data_type": "string",
          "required": true,
          "primary": false,
          "value_list": [
            "No Change",
            "Active",
            "Resolved",
            "Redirected"
          ],
          "default": "No Change"
        },
        "assigned_to": {
          "description": "Owner of the incident",
          "data_type": "string",
          "required": false,
          "primary": false
        },
        "category": {
          "description": "Classification and determination of the incident",
          "data_type": "string",
          "required": false,
          "primary": false,
          "value_list": [
            "No Change",
            "Informational: Security test",
            "Informational: Line-of-business application",
            "Informational: Confirmed activity",
            "Informational: Other",
            "False positive: Not malicious",
            "False positive: Not enough data to validate",
            "False positive: Other",
            "True positive: Multistage attack",
            "True positive: Malicious user activity",
            "True positive: Compromised account",
            "True positive: Malware",
            "True positive: Phishing",
            "True positive: Unwanted software",
            "True positive: Other"
          ],
          "default": "No Change"
        },
        "comment": {
          "description": "Comment to be added to the incident",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "list alert files",
      "identifier": "list_alert_files",
      "description": "Retrieves all files related to a specific alert.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-alert-related-files-info?view=o365-worldwide' target='_blank'>Microsoft Docs - Get alert related files information API</a>",
      "type": "investigative",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "alert_id": {
          "description": "Alert ID",
          "data_type": "numeric",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "list library scripts",
      "identifier": "list_library_scripts",
      "description": "List live response library files.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/list-library-files?view=o365-worldwide' target='_blank'>Microsoft Docs - List library files</a>",
      "type": "forensic",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {},
      "render": {},
      "output": []
    },
    {
      "action": "run actions",
      "identifier": "run_actions",
      "description": "Runs a sequence of live response commands on a device.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/run-live-response?view=o365-worldwide' target='_blank'>Microsoft Docs - Run live response commands on a device</a>",
      "type": "forensic",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "action_commands": {
          "description": "Action commands",
          "data_type": "string",
          "required": true,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "run action",
      "identifier": "run_action",
      "description": "Runs a single live response commands on a device.",
      "verbose": "<a href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/run-live-response?view=o365-worldwide' target='_blank'>Microsoft Docs - Run live response commands on a device</a>",
      "type": "forensic",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {
        "machine_id": {
          "description": "Machine ID",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "command_type": {
          "description": "Command Type",
          "data_type": "string",
          "required": true,
          "primary": false,
          "value_list": [
            "PutFile",
            "RunScript",
            "GetFile"
          ]
        },
        "file_name": {
          "description": "File Name/Script Name/Path",
          "data_type": "string",
          "required": true,
          "primary": false
        },
        "arguments": {
          "description": "Script arguments, if any",
          "data_type": "string",
          "required": false,
          "primary": false
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "list actions",
      "identifier": "list_actions",
      "description": "Retrieves a collection of Machine Actions.",
      "verbose": "<a class='external' href='https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-machineactions-collection' target='_blank'>Microsoft Docs - List MachineActions API</a>",
      "type": "type_goes_here",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {
        "filter": {
          "description": "filters to apply: (creationDateTimeUtc ge 2023-08-21T12:00:00Z and status eq 'Succeeded')",
          "data_type": "string",
          "required": false
        },
        "stop": {
          "description": "limit results to the first x results with max value of 10,000",
          "data_type": "numeric",
          "required": false,
          "default": 50
        },
        "skip": {
          "description": "skip the first x results",
          "data_type": "numeric",
          "required": false,
          "default": 0
        }
      },
      "render": {},
      "output": []
    },
    {
      "action": "get action result",
      "identifier": "get_action_result",
      "description": "description_goes_here",
      "verbose": "<a href='url_goes_here' target='_blank'>Microsoft Docs - title_goes_here</a>",
      "type": "type_goes_here",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {},
      "render": {},
      "output": []
    },
    {
      "action": "list investigations",
      "identifier": "list_investigations",
      "description": "description_goes_here",
      "verbose": "<a href='url_goes_here' target='_blank'>Microsoft Docs - title_goes_here</a>",
      "type": "type_goes_here",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {},
      "render": {},
      "output": []
    },
    {
      "action": "get investigation",
      "identifier": "get_investigation",
      "description": "description_goes_here",
      "verbose": "<a href='url_goes_here' target='_blank'>Microsoft Docs - title_goes_here</a>",
      "type": "type_goes_here",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {},
      "render": {},
      "output": []
    },
    {
      "action": "start investigation",
      "identifier": "start_investigation",
      "description": "description_goes_here",
      "verbose": "<a href='url_goes_here' target='_blank'>Microsoft Docs - title_goes_here</a>",
      "type": "type_goes_here",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {},
      "render": {},
      "output": []
    },
    {
      "action": "collect investigation package",
      "identifier": "collect_investigation_package",
      "description": "description_goes_here",
      "verbose": "<a href='url_goes_here' target='_blank'>Microsoft Docs - title_goes_here</a>",
      "type": "type_goes_here",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {},
      "render": {},
      "output": []
    },
    {
      "action": "list machine actions",
      "identifier": "list_machine_actions",
      "description": "description_goes_here",
      "verbose": "<a href='url_goes_here' target='_blank'>Microsoft Docs - title_goes_here</a>",
      "type": "type_goes_here",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {},
      "render": {},
      "output": []
    },
    {
      "action": "isolate machine",
      "identifier": "isolate_machine",
      "description": "description_goes_here",
      "verbose": "<a href='url_goes_here' target='_blank'>Microsoft Docs - title_goes_here</a>",
      "type": "type_goes_here",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {},
      "render": {},
      "output": []
    },
    {
      "action": "unisolate machine",
      "identifier": "unisolate_machine",
      "description": "description_goes_here",
      "verbose": "<a href='url_goes_here' target='_blank'>Microsoft Docs - title_goes_here</a>",
      "type": "type_goes_here",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {},
      "render": {},
      "output": []
    },
    {
      "action": "get file info",
      "identifier": "get_file_info",
      "description": "description_goes_here",
      "verbose": "<a href='url_goes_here' target='_blank'>Microsoft Docs - title_goes_here</a>",
      "type": "type_goes_here",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {},
      "render": {},
      "output": []
    },
    {
      "action": "get file stats",
      "identifier": "get_file_stats",
      "description": "description_goes_here",
      "verbose": "<a href='url_goes_here' target='_blank'>Microsoft Docs - title_goes_here</a>",
      "type": "type_goes_here",
      "read_only": true,
      "versions": "EQ(*)",
      "parameters": {},
      "render": {},
      "output": []
    },
    {
      "action": "quarantine file",
      "identifier": "quarantine_file",
      "description": "description_goes_here",
      "verbose": "<a href='url_goes_here' target='_blank'>Microsoft Docs - title_goes_here</a>",
      "type": "type_goes_here",
      "read_only": false,
      "versions": "EQ(*)",
      "parameters": {},
      "render": {},
      "output": []
    }
  ]
}